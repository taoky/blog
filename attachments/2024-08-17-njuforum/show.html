<!DOCTYPE html>
<html>
	<head>
		<title>Linux 201 and Misc</title>
		<meta charset="utf-8">
		<style>
      body { font-family: sans-serif; }
      h1, h2, h3 {
        font-family: sans-serif;
        font-weight: normal;
      }
      .remark-slide-content h1 {
        font-size: 52px;
      }
			a { text-decoration: none; }
			a:hover { text-decoration: underline; }
			.remark-code, .remark-inline-code { font-family: monospace; }
			.remark-code { font-size: 0.8em; }
			.remark-inline-code { font-size: 0.9em; padding: 0.2em 0.3em; border-radius: 6px; background-color: #eee; }
		</style>
  </head>
  <body>
    <textarea id="source" style="display: none;">

class: center, middle

# Linux 201 æ–‡æ¡£è®¡åˆ’ä¸æ‚è°ˆ

Keyu Tao, 2024/08/17

---

# Part I: Linux 201

- <https://201.ustclug.org>
- <https://github.com/ustclug/Linux201-docs>

---

## èµ·æº

- Linux 101 é¡¹ç›® (<https://101.lug.ustc.edu.cn>)
   - 2018 å¹´å¼€å§‹åœ¨æ¯å¹´çš„æ˜¥å­£å­¦æœŸå¼€æ´»åŠ¨ä»‹ç» Linux åŸºç¡€çŸ¥è¯†ï¼ˆåªæœ‰ Slidesï¼‰
   - 2020 å¹´å¯’å‡å¼€å§‹ç¼–å†™ Linux 101 çš„æ–‡æ¡£
     - [ç¬¬ä¸€ä¸ª commit](https://github.com/ustclug/Linux101-docs/commit/ea863a3cfa74623390185b4ca6ec33059ad6e8fc) åœ¨ 2020/1/31
     - COVID-19 => å¤§åŠå¹´å¾…å®¶é‡Œ => èƒ½è…¾å‡ºå¤§é‡é—²ç½®çš„æ—¶é—´å†™ä¸œè¥¿
   - ç›®å‰åŸºæœ¬å®Œå·¥ï¼Œå¤„äºç»´æŠ¤çŠ¶æ€
- Then?
   - ä»ã€Œç”¨æˆ·ã€åˆ°ã€Œé«˜çº§ç”¨æˆ·ã€ï¼ˆPower Userï¼‰ä¹‹é—´çš„ gap
   - ä»¥å¹´ä¸ºå•ä½å®è·µä¸è¸©å‘
   - æœ‰è¶³å¤Ÿç»éªŒ ä¸” æ„¿æ„åŠ å…¥ç»´æŠ¤çš„åŒå­¦å±äºç¨€ç¼ºèµ„æº
   - å¯ä»¥æŠŠè¿™äº›ç»éªŒæ•´ç†å‡ºæ¥å—ï¼Ÿ

---

## èµ·æº (cont.)

- 2021 å¹´åº•å¼€äº†ä¸€ä¸ªæ–°ä»“åº“
   - å½“æ—¶è¿˜å« "Linux 102"ï¼Œä½œä¸º Linux 101 çš„åç»­
   - ç„¶åâ€¦â€¦ç›´åˆ° 2023 å¹´ 9 æœˆå¼€å§‹æ‰æœ‰å®è´¨çš„æ›´æ–°
- å¼€å§‹æ›´æ–°æœ€ç›´æ¥çš„åŸå› ï¼šæ¥æ‰‹æŠ€æœ¯è®¾æ–½çš„åŒå­¦å®åŠ›ä¸è¶³ï¼Œè¿›åº¦æ¨è¿›æå…¶ç¼“æ…¢
   - ç¼ºå°‘è¶³å¤Ÿçš„å‰ç½®çŸ¥è¯†ï¼ŒæŠ€æœ¯æ–‡æ¡£ä¸å¤Ÿç”¨
   - å®Œå…¨æ— æ³•èå…¥æŠ€æœ¯äº¤æµ
- å³ä½¿æœ‰ç›¸å¯¹è¾ƒå¥½çš„åŸºç¡€çŸ¥è¯†ï¼Œæ¥æ‰‹ä»»åŠ¡ä»ç„¶ä¸å®¹æ˜“
   - ä»ã€Œé«˜çº§ç”¨æˆ·ã€åˆ°ã€Œç³»ç»Ÿç®¡ç†å‘˜ã€ä¹‹é—´ä»ç„¶æœ‰ä¸€å®šçš„ gap
      - ä¾‹å­ï¼šIPMI æ˜¯ä»€ä¹ˆï¼ŸSFF/LFF æ˜¯ä»€ä¹ˆï¼Ÿ
   - å­¦ç”Ÿè¿ç»´çš„å°è§„æ¨¡ => æ¯ä¸ªæˆå‘˜éƒ½éœ€è¦å¯¹å„ä¸ªæ–¹å‘æœ‰åŸºæœ¬çš„äº†è§£ï¼ˆæŸç§ç¨‹åº¦çš„å…¨æ ˆï¼Ÿï¼‰
- éœ€è¦ç±»ä¼¼äº Linux 101 çš„æ–‡æ¡£é¡¹ç›® => Linux 201
   - ä¸æ˜¯ã€Œå†…éƒ¨æŠ€æœ¯æ–‡æ¡£ã€ï¼šè¿™äº›çŸ¥è¯†åº”è¯¥æ˜¯é€šç”¨çš„
   - ç³»ç»Ÿä»‹ç»éœ€è¦äº†è§£çš„çŸ¥è¯†ä¸æŠ€èƒ½ï¼Œæä¾›å®è·µçš„æ–¹æ¡ˆï¼Œä»¥åŠç»éªŒä¸æ•™è®­

---

## è®¾è®¡

- ä¸‰ä¸ªå¤§æ¿å—
   - è¿ç»´ï¼ˆOpsï¼‰ï¼šåŒ…æ‹¬åŸºç¡€çš„è¿ç»´éœ€è¦äº†è§£çš„å†…å®¹ï¼Œä¾‹å¦‚æœåŠ¡ã€æ—¥å¿—ç®¡ç†ï¼Œå­˜å‚¨ç³»ç»Ÿï¼Œç½‘ç»œç­‰
   - å¼€å‘ï¼ˆDevï¼‰ï¼šä¸ºå¿«é€Ÿå…¥é—¨ï¼Œè°ƒè¯•ä¸é­”æ”¹ç°æœ‰ç¨‹åºè€Œè®¾è®¡çš„ä»‹ç»æ€§å†…å®¹
   - é«˜çº§/é€‰è¯»å†…å®¹ï¼šæˆç†Ÿåº¦ä¸è¶³ï¼Œæˆ–è€…ä¸ä¾¿äºåˆ†ç±»åˆ°ä¸Šè¿°ä¸¤è€…çš„å†…å®¹
- è®¾è®¡åŸåˆ™/å‰ç½®è¦æ±‚
   - Debian First
   - Linux 101 + C & Python åŸºç¡€
- è®¡åˆ’ç»“æ„å±•ç¤º

---

## äº®ç‚¹

- æŠŠåº•å±‚é€»è¾‘ææ¸…æ¥š
   - ä¾‹å­ï¼šNFS çš„ã€Œå­æ ‘æ£€æŸ¥ã€é€‰é¡¹
- æˆ‘ä»¬æ‹¥æœ‰çš„ç‹¬ç‰¹ç»éªŒ
   - ä¾‹å­ï¼šLVM éƒ¨åˆ†çš„ lvmcacheï¼ˆè™½ç„¶ç°åœ¨æˆ‘ä»¬ä¸ç”¨äº†ï¼‰

---

## è¿›åº¦

- tl;dr: è¿›å±•å¾ˆæ…¢
   - ç›¸æ¯”äº Linux 101ï¼Œç¼–å†™çš„é—¨æ§›æ›´é«˜ï¼Œä¹Ÿä¸å†æœ‰å¤§é‡çªåœ¨å®¶é‡Œçš„æ—¶é—´æ¡ä»¶
   - å®Œæˆåº¦å±•ç¤º

---

## æ¬¢è¿åŠ å…¥ï¼

- Linux 201 **ä¸æ˜¯**ä»…é™äºç§‘å¤§å­¦ç”Ÿæˆ–è€… USTCLUG æˆå‘˜ç¼–å†™çš„é¡¹ç›®
   - å¦‚æœä½ æƒ³å†™ä½œæŸä¸€éƒ¨åˆ†ï¼Œæ¬¢è¿è”ç³»ï¼
   - ä¹Ÿæ¬¢è¿æ‰è™«ï¼
- ç›®æ ‡ï¼šä¸ºå­¦ç”ŸæŠ€æœ¯ç¤¾å›¢å¸¦æ¥å®è´¨çš„çŸ¥è¯†å¸®åŠ©
   - å¯ä»¥ç›´æ¥ç»™æ–°äººæ‰” 201 çš„ç½‘ç«™é“¾æ¥

---

# Part II: æ‚è°ˆ

- akaã€Œæˆ‘é€ çš„é•œåƒç«™ç›¸å…³çš„å°å·¥å…·ä»‹ç»ã€
   - åŒæ­¥å·¥å…·
   - è¿ç»´å·¥å…·

---

## [tsumugu](https://github.com/taoky/tsumugu)

- é•œåƒç«™æœ‰çš„æ—¶å€™æ— æ³•ç”¨ rsync åŒæ­¥ä¸Šæ¸¸å†…å®¹
   - aptsync/yumsync åªé€‚ç”¨äº APT/YUM ä»“åº“
   - lftp/rclone æ¯ä¸ªæ–‡ä»¶éƒ½ä¼š HEADï¼Œå¹¶ä¸”æŸäº›ç«™ç‚¹æ— æ³•åŒæ­¥
- 2020 å¹´å°è¯•ä»¥ docker-ce ä¸ºç›®æ ‡å†™äº†ä¸€äº› Go ä»£ç ï¼Œå¼ƒå‘äº†
- 2023/7 é‡æ–°å¼€å†™
   - ä¸»è¦çš„ motivationï¼šproxmox ç”¨ lftp è¦è¶…è¿‡ 10 ä¸ªå°æ—¶æ‰èƒ½åŒæ­¥å®Œï¼Œä¸Šæ¸¸æ‹’ç»å¼€ rsync
   - è§£å†³æ–¹æ³•ï¼šparse HTML æ¥åˆ¤æ–­æ–‡ä»¶è¦ä¸è¦åŒæ­¥ï¼ˆè€Œä¸æ˜¯æ¯ä¸ªéƒ½å» HEAD ä¸€éï¼‰
   - Rustï¼ˆå¼ºç±»å‹åå¥½ + ä½œä¸ºè¯­è¨€ç»ƒä¹ ï¼‰
   - ç”±äºå¯ä»¥è‡ªå·±å†™ parserï¼Œå› æ­¤ lftp/rclone åŒæ­¥å›°éš¾çš„é¡µé¢ä¹Ÿå¯ä»¥åŒæ­¥
   - å…¶ä»–ç–‘éš¾é—®é¢˜ï¼ˆæ¯”å¦‚è¯´ docker-ce çš„ã€Œç‰¹æ€§ã€ï¼‰ä¹Ÿå¯ä»¥ç¼“è§£
- æœªæ¥å·¥ä½œ
   - å¤„ç† APT/YUM ä»“åº“éƒ¨åˆ†åŒæ­¥çš„ä¸ä¸€è‡´é—®é¢˜

---

## [yukina](https://github.com/taoky/yukina)

- å·¨å¤§ä¸”åˆ©ç”¨ç‡ä½çš„ä»“åº“çš„ caching æ–¹æ¡ˆ
   - nix-channelsï¼ˆåªåŒæ­¥è¿‘æœŸæ•°æ—¥çš„åŒ…ä¹Ÿéœ€è¦è¿‘ 5Tï¼‰
   - pypiï¼ˆbandersnatch åªå¢ä¸å‡ï¼Œ~20Tï¼‰
- OSPP 2021 çš„å°è¯•ï¼š[Rust ç¼–å†™çš„ caching server](https://github.com/SeanChao/mirror-cache)
   - Thanks to [@SeanChao](https://github.com/SeanChao)!
   - ä½†æ˜¯å› ä¸ºç§ç§åŸå› æ²¡æœ‰ç”¨ä¸ŠğŸ˜¢
- 2024/3 å¼€å†™ 
   - æ€è·¯ï¼šä» Nginx log äº†è§£æ–‡ä»¶çš„ã€Œæµè¡Œç¨‹åº¦ã€ï¼Œåœ¨å¤§å°çº¦æŸä¸‹ä¸‹è½½æµè¡Œçš„æ–‡ä»¶ï¼Œåˆ é™¤è¿‡æ°”çš„æ–‡ä»¶
   - ä¸éœ€è¦ç¹ççš„ web server é…ç½®ï¼Œä¹Ÿä¸éœ€è¦ç»´æŠ¤ä¸€å¥—ç‹¬ç«‹çš„ç³»ç»Ÿ
   - æœ€æ–°æ”¯æŒåª gc ä¸ä¸‹è½½ï¼Œå› æ­¤ï¼ˆå¯èƒ½ï¼‰å¯ä»¥å’Œ `proxy_store` ä¸€èµ·ç”¨
- ç»Ÿè®¡
   - å·²ç»ä¸º nix-channels éƒ¨ç½²ï¼Œ512G é™åˆ¶ä¸‹èƒ½å¤Ÿåšåˆ° ~80% å‘½ä¸­ç‡
   - PyPI å‘½ä¸­ç‡ ~85%

---

## [shadowmire](https://github.com/taoky/shadowmire/)

- é«˜æ ¡é•œåƒç«™ç®¡ç†å‘˜çš„å…±è¯†ï¼š[bandersnatch](https://github.com/pypa/bandersnatch/) å¾ˆçƒ‚ï¼Œä½†æ˜¯ä¸å¾—ä¸ç”¨
   - sync çš„æ—¶å€™ä¸ä¼šåˆ é™¤ä¸Šæ¸¸æ²¡äº†çš„åŒ…ï¼ˆä¾›åº”é“¾æ”»å‡»é—®é¢˜ï¼ï¼‰
   - verify å¾ˆæ…¢å¾ˆæ…¢ï¼ˆæ¯ä¸ªåŒ…éƒ½è¦å®Œæ•´æ›´æ–°ä¸€éï¼‰
   - æ— æ³•ä¸ºä¸‹æ¸¸æä¾›åŒæ­¥ï¼ˆéœ€è¦ XML-RPC APIï¼Œé•œåƒç«™ä¸å¯èƒ½å®ç°ï¼‰
   - ä¸ä¸€è‡´æ€§é—®é¢˜ï¼ˆæœ‰äº›åŒ…æ²¡æœ‰ JSON API æ–‡ä»¶ï¼Œæœ‰äº›åŒ…æ²¡æœ‰ `index.v1_json`/`index.v1_html`ï¼‰
- è§‚å¯Ÿ
   - PyPI çš„ XML-RPC API çš„ `list_packages_with_serial()` æ–¹æ³•ï¼Œå¯ä»¥è¿”å›æ‰€æœ‰åŒ…ä»¥åŠæœ€åæ›´æ–°çš„ serialï¼ˆå¯ä»¥çœ‹ä½œæ˜¯æŸç§æ—¶é—´è®¡æ•°å™¨ï¼‰
   - æœ¬åœ°ç»´æŠ¤ä¸€ä¸ªè½»é‡çš„æ•°æ®åº“ï¼ˆ`import sqlite3`ï¼‰
- é‚£å°±è‡ªå·±å†™ä¸€ä¸ªå§ï¼
   - ç›®å‰ LOC 1kï¼Œæ¯” bandersnatch å°ä¸€ä¸ªæ•°é‡çº§
   - æ”¯æŒåªåŒæ­¥ indexï¼Œå› æ­¤å¯ä»¥å’Œ yukina ä¸€èµ·ç”¨
- ä¸ TUNAï¼ˆ[@Harry-Chen](https://github.com/Harry-Chen/)ï¼‰åˆä½œéªŒè¯

---

## [ayano](https://github.com/taoky/ayano/)

- ä¸ºé•œåƒç«™ç‰¹åŒ–çš„è½»é‡çº§ Nginx log analyzer
   - follow access.log æ–‡ä»¶
   - ç­›é€‰å¤§è¯·æ±‚
   - æŒ‰ /24 æˆ–è€… /48 ç»Ÿè®¡æ€»å¤§å°
   - ä¸å¤„ç†ã€Œå¤§é‡å°è¯·æ±‚ã€çš„æƒ…å†µâ€”â€”å…¶ä»–çš„æ–¹æ³•å·²ç»å¯ä»¥æœ‰æ•ˆå¤„ç†è¿™ç§æƒ…å†µäº†
- æœ€æ–°ï¼šå¯¹ daemon mode çš„æ”¯æŒ
   - è¾“å‡ºæ—¥å¿—ï¼Œå¯ä»¥å–‚ç»™ fail2ban åŠ¨æ€ ban IP

---

## [chitose](https://github.com/taoky/chitose/)

- å’Œ iftop å¹²çš„äº‹æƒ…ç±»ä¼¼ï¼Œä½†æ˜¯å¯ä»¥æŒ‰ /24 æˆ–è€… /48 å½’ç±»ç»Ÿè®¡æµé‡
- `sudo pacman -S chitose`

---

## [admirror-speedtest](https://github.com/taoky/admirror-speedtest/)

- USTC Mirrors æœ‰å¤šä¸ªä¸åŒ ISP çš„å‡ºå£ IP
   - åœ¨ç¼–å†™åŒæ­¥ä»»åŠ¡é…ç½®çš„æ—¶å€™æ€ä¹ˆçŸ¥é“å“ªä¸ªå‡ºå£æœ€å¿«ï¼Ÿ
- æµ‹é€Ÿæ–¹æ³•
   - ä»¥ä¸åŒçš„ IP é…ç½®å¯åŠ¨ rsync/curl/wget/git
   - æµ‹è¯• 3 è½®ï¼Œæ¯ä¸ªæµ‹è¯• 30 ç§’
- æœ‰è¶£çš„ç»†èŠ‚
   - å‘ç°äº† rsync çš„ä¸€ä¸ª [bug](https://github.com/RsyncProject/rsync/issues/413)ï¼Œä¼šå¯¼è‡´ rsync æ— æ³•æ­£ç¡® kill è‡ªå·±çš„å­è¿›ç¨‹
   - git ä¸æ”¯æŒä¿®æ”¹ `bind()` çš„ IP
      - é‚£å°± `LD_PRELOAD` é­”æ”¹ï¼š[libbinder](https://github.com/taoky/libbinder)
      - ä¹Ÿäº†è§£åˆ°äº† seccomp user notificationï¼ˆä½†æ˜¯æœ‰ç‚¹éº»çƒ¦ï¼Œå°±æ²¡ç”¨ï¼‰
      - è¿™ä¹Ÿæ˜¯ Hackergame 2023 çš„é¢˜ç›® [`ä¸ºä»€ä¹ˆè¦æ‰“å¼€ /flag ğŸ˜¡`](https://github.com/USTC-Hackergame/hackergame2023-writeups/blob/master/official/%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E6%89%93%E5%BC%80%20flag%20%F0%9F%98%A1/README.md) çš„æ€è·¯æ¥æº
- æœªæ¥å·¥ä½œ
   - æ”¯æŒ Docker networkï¼Ÿ

---

## [gitkeeper](https://github.com/taoky/gitkeeper)

- æœåŠ¡å™¨æœ‰ä¸€äº›é…ç½®ä»¥ git ä»“åº“çš„é…ç½®å­˜åœ¨
   - ä½†æ˜¯å¾ˆå¤šæ—¶å€™æ”¹äº†ä¹‹åå¿˜äº† commit/push
   - `git` åœ¨æŸä¸ª CVE ä¹‹åï¼ŒåŠ å¼ºäº†æƒé™æ£€æŸ¥
      - å¯¼è‡´æ¯æ¬¡éƒ½è¦ `sudo -u someuser git -c user.name=example -c user.email=someuser@example.com commit ...`
      - æ›´æ²¡äººæ„¿æ„ commit äº†
- gitkeeper æ˜¯è½»é‡ã€ç³»ç»Ÿçº§çš„ git é…ç½®ä»“åº“ç®¡ç†å™¨
   - ä¼šå¸®ä½  `sudo`ï¼Œå¸®ä½ å¡«ä¸Šæ­£ç¡®çš„ `user.name` å’Œ `user.email`ï¼Œå¸®ä½ å¯¹ä¸æ˜¯ä½ çš„ç”¨æˆ·çš„ä»“åº“ä¹Ÿç”¨ä¸Šä½ è‡ªå·±çš„ `.gitconfig`
   - `gitkeeper status` ä¸€æ¡å‘½ä»¤æŸ¥çœ‹ç³»ç»Ÿä»“åº“çŠ¶æ€
   - `gitkeeper diff`/`gitkeeper commit`/`gitkeeper update`
   - `alias gitk="gitkeeper vcs ."`
      - ç„¶åå°±åƒç”¨ `git` ä¸€æ ·ç”¨ `gitk`

---

## Q & A?

    </textarea>
    <script src="https://remarkjs.com/downloads/remark-latest.min.js">
    </script>
    <script>
      var slideshow = remark.create({
        navigation: {
          scroll: false
        }
      });
    </script>
  </body>
</html>
